---
title: "Introducing SSL certificate management operations"
ms.reviewer: 
ms.author: v-nsatapathy
author: nimishasatapathy
manager: serdars
ms.date: 06/20/2022
audience: ITPro
f1.keywords:
- NOCSH
ms.topic: article
ms.prod: sharepoint-server-itpro
ms.localizationpriority: medium
ms.collection: IT_Sharepoint_Server_Top
ms.assetid: 88317397-e0cb-47c7-9093-7872bc685213
description: "Learn how you can use Secure Sockets Layer (SSL) certificate management to monitor and manage the lifecycle of SSL certificates in your SharePoint farm."
---

# Introducing SSL certificate management operations

[!INCLUDE[appliesto-xxx-xxx-xxx-SUB-xxx-md](../includes/appliesto-xxx-xxx-xxx-SUB-xxx-md.md)]
  
The Secure Sockets Layer (SSL) certificate management feature allows you to monitor and manage the lifecycle of SSL certificates in your SharePoint farm, from acquisition and deployment to usage, expiration, and renewal.    

This article focuses on the following SSL certificate management operations.
  
## Creating new certificates

SharePoint Subscription Edition supports creating SSL certificate requests via the [New-SPCertificate](/powershell/module/sharepoint-server/new-spcertificate) PowerShell cmdlet. This is the first step in a three-step process to install a new SSL certificate.

```powershell
New-SPCertificate -FriendlyName <String> -CommonName <String> [-AlternativeNames <String[]>] [-OrganizationalUnit <String>] [-Organization <String>] [-Locality <String>] [-State <String>] [-Country <String>] [-Exportable] [-HashAlgorithm {Default | SHA256 | SHA384 | SHA512}] [-Path <String>] [-Force] [<CommonParameters>]
New-SPCertificate -FriendlyName <String> -CommonName <String> [-AlternativeNames <String[]>] [-OrganizationalUnit <String>] [-Organization <String>] [-Locality <String>] [-State <String>] [-Country <String>] [-Exportable] [-KeySize {0 | 2048 | 4096 | 8192 | 16384}] [-HashAlgorithm {Default | SHA256 | SHA384 | SHA512}] [-Path <String>] [-Force] [<CommonParameters>]
New-SPCertificate -FriendlyName <String> -CommonName <String> [-AlternativeNames <String[]>] [-OrganizationalUnit <String>] [-Organization <String>] [-Locality <String>] [-State <String>] [-Country <String>] [-Exportable] [-EllipticCurve {Default | nistP256 | nistP384 | nistP521}] [-HashAlgorithm {Default | SHA256 | SHA384 | SHA512}] [-Path <String>] [-Force] [<CommonParameters>]]
```

After the SSL certificate request has been created via the operation, the SharePoint administrator must submit the certificate request to their SSL certificate authority. The SSL certificate authority then generates a signed certificate based on the request and return it to the SharePoint administrator, who can then import the certificate into SharePoint. The imported certificate is paired with the private key generated by the certificate request operation. The certificate is now ready for use by SharePoint.

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|FriendlyName| The friendly name for the certificate. This name can be used to help you remember the purpose of this certificate. The friendly name will only be visible to SharePoint farm administrators, not to end users.|
|CommonName | The primary DNS domain name or IP address that this certificate will be assigned to. Fully Qualified Domain Names (FQDNs) are recommended.|
|AlternativeNames | Additional DNS domain names or IP addresses that this certificate will be assigned to. Fully Qualified Domain Names (FQDNs) are recommended.|
|OrganizationalUnit | The name of your department within your organization or company. If this parameter isn't specified, the default organizational unit of the farm will be used.|
|Organization| The legally registered name of your organization or company. If this parameter isn't specified, the default organization of the farm will be used.|
|Locality | The name of the city or locality where your organization is legally located. Don't abbreviate the name. If this parameter isn't specified, the default locality of the farm will be used.|
|State | The name of the state or province where your organization is legally located. Don't abbreviate the name. If this parameter isn't specified, the default state of the farm will be used.|
|Country | The two letter country code where your organization is legally located. This must be an ISO 3166-1 alpha-2 country code. If this parameter isn't specified, the default country of the farm will be used.|
|Exportable| Specifies whether the private key of the certificate may be exported. If this parameter isn't specified, the private key of certificate deployed to the Windows Certificate Store on each server in the SharePoint farm won't be exportable, and SharePoint won't allow you to export the private key from within the SharePoint administration interface.|
|KeySize | Specifies to use the RSA key algorithm for your certificate, and the size of your public and private RSA keys in bits. Larger key sizes provide more cryptographic strength than smaller key sizes, but they're also more computationally expensive and take more time to complete the SSL / TLS connection. Select `2048` if you're unsure which key size to use. Key sizes larger than `4096` are not recommended. If neither this parameter nor the `EllipticCurve` parameter is specified, the default key algorithm and key size / elliptic curve of the farm will be used.|
|EllipticCurve|Specifies to use the elliptic curve cryptography key algorithm for your certificate, and the elliptic curve of your public and private ECC keys. Larger elliptic curves provide more cryptographic strength than smaller elliptic curves, but they're also more computationally expensive and take more time to complete the SSL / TLS connection. Select `nistP256` if you're unsure which elliptic curve to use. Elliptic curves larger than `nistP384` are not recommended. If neither this parameter nor the `KeySize` parameter is specified, the default key algorithm and key size / elliptic curve of the farm will be used.|
|HashAlgorithm|Specifies the hash algorithm of your certificate signature, which your certificate authority will use to verify that your certificate request hasn't been tampered with. Larger hash algorithms provide more cryptographic strength than smaller hash algorithms, but they're also more computationally expensive. Select `SHA256` if you're unsure which hash algorithm to use. Hash algorithms larger than `SHA384` are not recommended. If this parameter isn't specified, the default hash algorithm of the farm will be used.|
|Path|Specifies the path to the certificate signing request file that will be generated.|
|Force| Specifies to overwrite a file if it already exists at the specified path.|
|AssignmentCollection| Manages objects for the purpose of proper disposal. Use of objects, such as SPWeb or SPSite, can use large amounts of memory and use of these objects in Windows PowerShell scripts requires proper memory management. Using the `SPAssignment` object, you can assign objects to a variable and dispose of the objects after they are needed to free up memory. When SPWeb, SPSite, or `SPSiteAdministration` objects are used, the objects are automatically disposed of if an assignment collection or the Global parameter is not used.|
|WhatIf|Shows what would happen if the cmdlet runs. The cmdlet is not run.|
|Confirm|Prompts you for confirmation before running the cmdlet.|

Example cmdlet syntax:

```powershell
New-SPCertificate -FriendlyName "Team Sites Certificate" -KeySize 2048 -CommonName sharepoint.contoso.com -AlternativeNames extranet.contoso.com, onedrive.contoso.com -OrganizationalUnit "Contoso IT Department" -Organization "Contoso" -Locality "Redmond" -State "Washington" -Country "US" -Exportable -HashAlgorithm SHA256 -Path "\\server\fileshare\Team Sites Certificate Signing Request.txt"
```

## Importing certificates

SharePoint supports both RSA and Elliptic Curve Cryptography (ECC) certificates. You can import certificates from PFX (PKCS #12) files, P7B (PKCS #7) files, and CER files. Only PFX files will contain private keys for certificates, which are necessary for a server certificate to be assigned to an IIS website. However, the entire certificate chain, from the end entity (leaf) certificate to the root certificate must be imported to SharePoint for SSL connections to be successful.

Certificates are automatically deployed to the Windows certificate store on each server in the SharePoint farm when they're imported into SharePoint. Certificates are also automatically deployed to new servers in the SharePoint farm when those servers join the farm.

> [!NOTE]
> Disconnecting a server from a SharePoint farm will not automatically remove SharePoint-managed certificates from that server's Windows certificate store. Uninstalling SharePoint from a server will not automatically remove SharePoint-managed certificates from that server's Windows certificate store.

Use the [Import-SPCertificate](/powershell/module/sharepoint-server/import-spcertificate) PowerShell cmdlet to import certificates from certificate files.


```powershell
Import-SPCertificate [-Path] <String> [-Password <SecureString>] [-Store {EndEntity | Intermediate | Pending | Root}] [-Exportable] [-Replace] [-AssignmentCollection <SPAssignmentCollection>] [-WhatIf] [-Confirm] [<CommonParameters>]
```

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|Path| The path to the PFX, P7B, or CER file containing certificates.|
|Password | The password if the certificate file is protected by a password (for PFX files).|
|Store (EndEntity / Intermediate / Pending / Root)| The certificate store that certificates should be imported into. Unless there's a need to override SharePoint's automatic certificate detection, we recommend omitting this parameter, so that SharePoint will automatically select the appropriate certificate store for each certificate.|
|Exportable| Specifies whether private keys of the certificates imported into SharePoint may be exported. If this parameter isn't specified, the private keys of certificates deployed to the Windows Certificate Store on each server in the SharePoint farm won't be exportable, and SharePoint won't allow you to export the private keys from within the SharePoint administration interface.|
|Replace| Specifies that if the certificates being imported are renewing existing certificates, the certificate assignments of the existing certificates should be immediately replaced with the imported certificates.|

Example cmdlet syntax:

```powershell
$password = ConvertTo-SecureString -AsPlainText -Force 
Import-SPCertificate -Path "\\server\fileshare\certificates.pfx" -Password $password -Exportable
```

## Assigning certificates to web applications

SharePoint supports assigning SharePoint-managed certificates, which are imported by using the [Import-SPCertificate](/powershell/module/sharepoint-server/import-spcertificate) PowerShell cmdlet, to web applications with an SSL binding. The certificate must be in SharePoint's End Entity certificate store and the certificate's private key must also be imported. You can assign a certificate when the web application is first created or after it's created.

A `-Certificate <SPServerCertificatePipeBind>` parameter has been added to the following cmdlets and commands:

- [New-SPWebApplication](/powershell/module/sharepoint-server/new-spwebapplication)
- [New-SPWebApplicationExtension](/powershell/module/sharepoint-server/new-spwebapplicationextension)
- [Set-SPWebApplication](/powershell/module/sharepoint-server/set-spwebapplication)
- [New-SPCentralAdministration](/powershell/module/sharepoint-server/new-spcentraladministration)
- [Set-SPCentralAdministration](/powershell/module/sharepoint-server/set-spcentraladministration)
- [PSConfig.exe -cmd adminvs](/previous-versions/office/sharepoint-server-2010/cc263093(v=office.14))

The `SPServerCertificatePipeBind` accepts the following values:

- **String:** Friendly name of the certificate.
- **String:** Thumbprint of the certificate.
- **String:** Serial number of the certificate.
- **GUID:** ID property of the SPServerCertificate object.

To assign a certificate to a web application when creating that web application or extending a web application to an additional zone through Central Administration, set "Use Server Sockets Layer (SSL)" to Yes, and then select the server certificate from the Server Certificate drop-down list.

## Replacing a certificate assignment

SharePoint supports replacing all usage of an existing certificate within SharePoint with a different certificate. For example, if an existing certificate is approaching its expiration and you can replace this existing certificate with a new certificate. Use the [Switch-SPCertificate](/powershell/module/sharepoint-server/switch-spcertificate) Powershell cmdlet to replace the assignments of the existing certificate with the new certificate. All usage of the existing certificate within SharePoint will then be replaced with the new certificate.

For example:

```powershell
Switch-SPCertificate [-Identity] <SPServerCertificatePipeBind> [-NewCertificate] <SPServerCertificatePipeBind> [-WhatIf] [-Confirm] [<CommonParameters>]
```

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|Identity| The certificate whose assignments you want to replace.|
|NewCertificate | The certificate that should replace all of the assignments of the certificate specified by the Identity parameter.|

For example:

```powershell
Switch-SPCertificate -Identity "Contoso SharePoint (2020)" -NewCertificate "Contoso SharePoint (2021)"
```

## Removing certificates

SharePoint supports removing certificates via [Remove-SPCertificate](/powershell/module/sharepoint-server/remove-spcertificate) PowerShell cmdlet.

> [!Note]
>
>- By default, SharePoint will not allow you to remove a certificate if it is currently assigned to a SharePoint object. You must override the default behavior if you want to force the removal of a certificate. If you override the default behavior, existing assignments of the certificate are cleared.
>- The certificate and any private key associated with that certificate is removed from the Windows certificate store on every server in the SharePoint farm.
>- The certificate and any private key associated with it is removed from the SharePoint configuration database.
>- Any previous exports from the certificate through the SharePoint administration interface will not be removed. Those exported files will still exist.

Use the `Remove-SPCertificate` cmdlet to remove a certificate from SharePoint.

For example:

```powershell
Remove-SPCertificate [-Identity] <SPServerCertificatePipeBind> [-Force] [-WhatIf] [-Confirm] [<CommonParameters>]
```

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|Identity| The certificate to remove from SharePoint.|
|Force | Specifies that the certificate should be removed from SharePoint, even if the certificate is currently assigned to SharePoint objects. If this parameter is specified, any existing assignments of the certificate are also cleared. If this parameter isn't specified and the certificate is assigned to a SharePoint object, the operation will fail.|


For example:

```powershell
Remove-SPCertificate -Identity "Contoso SharePoint (2020)"
```

## Finding/viewing certificates

SharePoint supports finding certificates via the [Get-SPCertificate](/powershell/module/sharepoint-server/get-spcertificate) PowerShell cmdlet. Optional parameters are available to filter the results returned by this cmdlet.

```powershell
Get-SPCertificate [-Identity] <SPServerCertificatePipeBind>
Get-SPCertificate [-DisplayName] <String> [-Thumbprint <String>] [-SerialNumber <String>] [-Store {EndEntity | Intermediate | Pending | Root}] [-InUse] [-DaysToExpiration <Int32>] [-WhatIf] [-Confirm] [<CommonParameters>]
```

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|Identity| Specifies the display name, thumbprint, serial number, or GUID of the certificate to find. If multiple certificates match the identity specified, no certificates will be returned. Use the filtering criteria of the optional parameters when multiple certificates would match.|
|DisplayName| The display name of the certificate to find. Use this parameter instead of the Identity parameter if multiple certificates might match this criteria. The Identity parameter can only return a single certificate.|
|Thumbprint| The thumbprint of the certificate to find, in the form "1234567890ABCDEF1234567890ABCDEF12345678".|
|SerialNumber| The serial number of the certificate to find, in the form "1234567890ABCDEF1234567890ABCDEF"|
|Store (EndEntity / Intermediate / Pending / Root)| Specifies the certificate store to search. If this parameter isn't specified, all certificate stores will be searched.|
|InUse| Specify to only return certificates that are directly assigned to SharePoint objects (that is, currently in use).|
|DaysToExpiration |If a positive number, only return certificates that will expire in the number of days from now specified by this parameter. Specify "-1" to only return certificates that have already expired. Specifying "0" will result in no filtering based on expiration date.|

The following are the examples of cmdlet syntax:

```powershell
- Get-SPCertificate -FriendlyName "Contoso SharePoint (2020)"
- Get-SPCertificate -InUse -DaysToExpiration 30
```

## Exporting certificate

SharePoint supports exporting certificates to PFX (PKCS #12) files, P7B (PKCS #7) files, and CER files. Both PFX files and P7B files can contain multiple certificates, which is useful for exporting a chain of certificates from the end entity (leaf) certificate to the root certificate. However, only PFX files can contain private keys for certificates, which are necessary for a server certificate to be assigned to an IIS website. CER files contain only a single certificate.

Use the [Export-SPCertificate](/powershell/module/sharepoint-server/export-spcertificate) PowerShell cmdlet to import certificates from certificate files.

This cmdlet supports multiple parameter sets:

```powershell
Export-SPCertificate [-Identity] <SPServerCertificatePipeBind> -Password <securestring> [-EncryptionType {AES256 | TripleDes}] [-IncludeAllCertificatesInCertificationPath] [-NoExtendedProperties] [-Path <string>] [-Force]
Export-SPCertificate [-Identity] <SPServerCertificatePipeBind> -Type {Cert | Pkcs7} [-IncludeAllCertificatesInCertificationPath] [-Path <string>] [-Force]
```


The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|Identity| The certificate to export.|
|Password| The password to use to protect the exported PFX file. This parameter is only compatible with PFX files.|
|EncryptionType (AES256 / TripleDes)| Specifies the encryption algorithm to use to protect the exported PFX file. <p> `AES256` specifies that AES-256 encryption with SHA256 hashing will be used. `TripleDes` specifies that 3DES encryption with SHA1 hashing will be used. AES-256 encryption is stronger than 3DES encryption, but is only supported with PFX files on Windows Server 2019 and newer operating systems. <p>Use 3DES encryption if the PFX file needs to be compatible with older operating systems. If this parameter isn't specified, AES-256 encryption is used by default. This parameter is only compatible with PFX files.|
|Type (Cert / Pkcs7)| Specifies the type of file to generate. `Cert` will generate a CER file containing a single DER-encoded certificate. `Pkcs7` will generate a P7B (PKCS #7) file containing one or more certificates. This parameter is only compatible with CER and P7B files.|
|IncludeAllCertificatesInCertificationPath| Specifies whether to export additional certificates that are part of the certificate chain of the specified certificate. This will only add parent certificates of the specified certificate, not child certificates issued by the specified certificate. This parameter is only compatible with PFX and P7B files.|
|NoExtendedProperties| Specifies whether extended properties of the certificate should not be exported, such as the friendly name of the certificate. This parameter is only compatible with PFX files.|
|Path| The path to the PFX, P7B, or CER file that the certificates should be exported to.|
|Force| Specifies whether to overwrite a file if it already exists at the specified path.|

The following is the example of cmdlet syntax:

```powershell
$password = ConvertTo-SecureString -AsPlainText -Force 
Export-SPCertificate -Identity "Contoso SharePoint (2020)" -Password $password -IncludeAllCertificatesInCertificationPath - NoExtendedProperties -Path "\server\fileshare\certificates.pfx"
```

## Outgoing SMTP support for client certificate authentication

Some SMTP servers may require the use of client certificates for authentication before accepting email messages. SharePoint now supports client certificate authentication when sending emails to an SMTP server. The outbound SMTP settings in SharePoint must be configured to use TLS connection encryption and a certificate must be assigned to use this capability. The certificate must be in SharePoint's End Entity certificate store, the certificate's private key must be imported, and the certificate's enhanced key usage extension must specify the certificate is valid for client authentication if that extension is present.

A `-Certificate <SPServerCertificatePipeBind>` parameter has been added to the following cmdlet parameter set:

```powershell
Set-SPWebApplication [-Identity] <SPWebApplicationPipeBind> -SMTPServer <String> [-Certificate <SPServerCertificatePipeBind>] [-DisableSMTPEncryption] [-Force] [-NotProvisionGlobally] [-OutgoingEmailAddress <String>] [-ReplyToEmailAddress <String>] [-SMTPServerPort <Int32>] [-SMTPCredentials <PSCredential>]
```

To assign a certificate to the outbound SMTP settings through Central Administration, set Use TLS connection encryption and Use client certificate authentication to **Yes**, and then select the client certificate from the **Client certificate** drop-down list.

## Renewing certificates

SharePoint supports renewing SSL certificates via the [Renew-SPCertificate](/powershell/module/sharepoint-server/renew-spcertificate) PowerShell cmdlet. This creates a new certificate signing request based on the properties of an existing certificate and is the first step in a three-step process to renew an SSL certificate.

Once an SSL certificate request is created via the operation, the SharePoint administrator must submit the certificate request to their SSL certificate authority. The SSL certificate authority will then generate a signed certificate based on the request and return it to the SharePoint administrator. The SharePoint administrator must then import the certificate provided by the SSL certificate authority into SharePoint.

SharePoint will then pair the imported certificate with the private key generated by the certificate request operation. The certificate is then ready to be used by SharePoint.

When you import a certificate as part of a certificate renewal operation, you can specify the `Replace` switch parameter with the `Import-SPCertificate` cmdlet. This tells SharePoint to automatically replace the certificate assignments of the certificate being renewed with the new certificate.

```powershell
Renew-SPCertificate [-Identity] <SPServerCertificatePipeBind> -FriendlyName <String> [-CommonName <String>] [-AlternativeNames <String[]>] [-OrganizationalUnit <>] [-Organization <String>] [-Locality <String>] [-State <String>] [-Country <String>] [-Exportable] [-HashAlgorithm {Default | SHA256 | SHA384 | SHA512}] [-Path <String>] [-Force] [<CommonParameters>]
Renew-SPCertificate [-Identity] <SPServerCertificatePipeBind> -FriendlyName <String> [-CommonName <String>] [-AlternativeNames <String[]>] [-OrganizationalUnit <>] [-Organization <String>] [-Locality <String>] [-State <String>] [-Country <String>] [-Exportable] [-KeySize {0 | 2048 | 4096 | 8192 | 16384}] [-HashAlgorithm {Default | SHA256 | SHA384 | SHA512}] [-Path <String>] [-Force] [<CommonParameters>]
Renew-SPCertificate [-Identity] <SPServerCertificatePipeBind> -FriendlyName <String> [-CommonName <String>] [-AlternativeNames <String[]>] [-OrganizationalUnit <>] [-Organization <String>] [-Locality <String>] [-State <String>] [-Country <String>] [-Exportable] [-EllipticCurve {Default | nistP256 | nistP384 | nistP521}] [-HashAlgorithm {Default | SHA256 | SHA384 | SHA512}] [-Path <String>] [-Force] [<CommonParameters>]
```

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|Identity| The certificate to be renewed.|
|FriendlyName | The friendly name for the certificate. This name can be used to help you remember the purpose of this certificate. The friendly name will only be visible to SharePoint farm administrators, not to end users.|
|CommonName  |The primary DNS domain name or IP address that this certificate will be assigned to. Fully Qualified Domain Names (FQDNs) are recommended. If this parameter isn't specified, the common name of the certificate to be renewed will be used.|
|AlternativeNames | Additional DNS domain names or IP addresses that this certificate will be assigned to. Fully Qualified Domain Names (FQDNs) are recommended. If this parameter isn't specified, the alternative names of the certificate to be renewed will be used.|
|OrganizationalUnit| The name of your department within your organization or company. If this parameter isn't specified, the organizational unit of the certificate to be renewed will be used. If an organizational unit can't be found in the certificate to be renewed, the default organizational unit of the farm will be used.|
|Organization| The legally registered name of your organization or company. If this parameter isn't specified, the organization of the certificate to be renewed will be used. If an organization can't be found in the certificate to be renewed, the default organization of the farm will be used.|
|Locality | The name of the city or locality where your organization is legally located. Don't abbreviate the name. If this parameter isn't specified, the locality of the certificate to be renewed will be used. If a locality can't be found in the certificate to be renewed, the default locality of the farm will be used.|
|State | The name of the state or province where your organization is legally located. Don't abbreviate the name. If this parameter isn't specified, the state of the certificate to be renewed will be used. If a state can't be found in the certificate to be renewed, the default state of the farm will be used.|
|Country | The two letter country code where your organization is legally located. This must be an ISO 3166-1 alpha-2 country code. If this parameter isn't specified, the country of the certificate to be renewed will be used. If a country can't be found in the certificate to be renewed, the default country of the farm will be used.|
|Exportable| Specifies whether the private key of the certificate may be exported. If this parameter is not specified, the private key of certificate deployed to the Windows Certificate Store on each server in the SharePoint farm won't be exportable, and SharePoint won't allow you to export the private key from within the SharePoint administration interface.|
|KeySize| Specifies to use the RSA key algorithm for your certificate, and the size of your public and private RSA keys in bits. Larger key sizes provide more cryptographic strength than smaller key sizes, but they're also more computationally expensive and take more time to complete the SSL/TLS connection. Select `2048` if you're unsure which key size to use. Key sizes larger than `4096` are not recommended. If neither this parameter nor the EllipticCurve parameter is specified, the key algorithm and key size / elliptic curve of the certificate to be renewed will be used. If a key algorithm and key size / elliptic curve can't be found in the certificate to be renewed, the default key algorithm and key size / elliptic curve of the farm will be used.|
|EllipticCurve| Specifies to use the elliptic curve cryptography key algorithm for your certificate, and the elliptic curve of your public and private ECC keys. Larger elliptic curves provide more cryptographic strength than smaller elliptic curves, but they're also more computationally expensive and take more time to complete the SSL/TLS connection. Select `nistP256` if you're unsure which elliptic curve to use. Elliptic curves larger than `nistP384` are not recommended. If neither this parameter nor the KeySize parameter is specified, the key algorithm and key size / elliptic curve of the certificate to be renewed will be used. If a key algorithm and key size / elliptic curve can't be found in the certificate to be renewed, the default key algorithm and key size / elliptic curve of the farm will be used.|
|HashAlgorithm| Specifies the hash algorithm of your certificate signature, which your certificate authority will use to verify that your certificate request hasn't been tampered with. Larger hash algorithms provide more cryptographic strength than smaller hash algorithms, but they're also more computationally expensive. Select `SHA256` if you're unsure which hash algorithm to use. Hash algorithms larger than `SHA384` are not recommended. If this parameter is not specified, the hash algorithm of the certificate to be renewed will be used. If a supported hash algorithm can't be found in the certificate to be renewed, the default hash algorithm of the farm will be used.|

The following is the example of cmdlet syntax:

```powershell
Renew-SPCertificate -Identity "Contoso SharePoint (2020)" -FriendlyName "Contoso SharePoint (2021)" -Exportable -Path "\\server\fileshare\Contoso SharePoint 2021 Certificate Signing Request.txt"
```

## Renaming certificate friendly names

SharePoint supports changing the friendly name of certificates using the [Rename-SPCertificate](/powershell/module/sharepoint-server/rename-spcertificate) PowerShell cmdlet.

```powershell
Rename-SPCertificate [-Identity] <SPServerCertificatePipeBind> -NewFriendlyName <string>
```

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|Identity| The certificate to be renamed. |
|NewFriendlyName|The new friendly name for the certificate.|

Example cmdlet syntax:

```powershell
Rename-SPCertificate -Identity "Contoso SharePoint" -NewFriendlyName "Contoso SharePoint (2020)"
```

## Moving certificates between certificate stores

SharePoint supports moving certificates between certificate stores using the [Move-SPCertificate](/powershell/module/sharepoint-server/move-spcertificate) PowerShell cmdlet.

```powershell
Move-SPCertificate [-Identity] <SPServerCertificatePipeBind> -NewStore {Default | EndEntity | Intermediate | Root} [-Force]
```

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|Identity| The certificate to move.|
|NewStore (Default / EndEntity / Intermediate / Root)| The certificate store to move the certificate to. If Default is specified, SharePoint will automatically select the appropriate certificate store for the certificate.|
|Force|Specifies that the certificate should be moved to a different certificate store, even if the certificate is currently assigned to SharePoint objects.<br> If this parameter is specified, any existing assignments of the certificate are cleared. If this parameter isn't specified and the certificate is assigned to a SharePoint object, the operation will fail.|

Example cmdlet syntax:

```powershell
Move-SPCertificate -Identity "Contoso SharePoint (2020)" -NewStore EndEntity
```

## View certificate default settings

SharePoint supports farm-wide default settings for certificate management. These include default properties for creating and renewing certificates and certificate health rule thresholds.

Use the [Get-SPCertificateSettings](/powershell/module/sharepoint-server/get-spcertificatesettings) PowerShell cmdlet to view the certificate management default settings.

## Set certificate default settings

SharePoint supports farm-wide default settings for certificate management. These include default properties for creating and renewing certificates and certificate health rule thresholds.

Use the [Set-SPCertificateSettings](/powershell/module/sharepoint-server/set-spcertificatesettings) PowerShell cmdlet to set the certificate management default settings.

```powershell
Set-SPCertificateSettings [-OrganizationalUnit <String>] [-Organization <String>] [-Locality <String>] [-State <String>] [-Country <String>] [-KeyAlgorithm {ECC | RSA}] [-KeySize {0 | 2048 | 4096 | 8192 | 16384}] [-EllipticCurve {Default | nistP256 | nistP384 | nistP521}] [-HashAlgorithm {Default | SHA256 | SHA384 | SHA512}] [-RsaSignaturePadding {Default | Pkcs1 | Pss}] [-CertificateExpirationAttentionThreshold <Int32>] [-CertificateExpirationWarningThreshold <Int32>] [-CertificateExpirationErrorThreshold <Int32>] [<CommonParameters>]]
```

The cmdlet parameters are:

|Parameter|Description|
|--- |--- |
|OrganizationalUnit | The name of your department within your organization or company.|
|Organization | The legally registered name of your organization or company.|
|Locality | The name of the city or locality where your organization is legally located. Don't abbreviate the name.|
|State | The name of the state or province where your organization is legally located. Don't abbreviate the name.|
|Country | The two letter country code where your organization is legally located. This must be an ISO 3166-1 alpha-2 country code.|
|KeyAlgorithm (ECC / RSA)| Specifies the key algorithm for your certificate. This choice will be used for both the public key and the private key of your certificate. <p>`RSA` is the most common and widely supported key algorithm for certificates. Select the RSA algorithm if you're unsure which type of key your certificate authority supports. `ECC` uses elliptic curve cryptography based on ECDSA keys with NIST P-256, P-384, or P-521 curves. <p>SSL/TLS connections are faster to complete with `ECC` certificates than `RSA` certificates at the equivalent security strength. Verify that your certificate authority supports `ECC` certificates before selecting it.|
|KeySize (0 / 2048 / 4096 / 8192 / 16384)| Specifies the size of your public and private RSA keys in bits. Larger key sizes provide more cryptographic strength than smaller key sizes, but they're also more computationally expensive and take more time to complete the SSL/TLS connection. <p>Select `2048` if you're unsure which key size to use. Key sizes larger than `4096` aren't recommended.|
|EllipticCurve (Default / nistP256 / nistP384 / nistP521)| Specifies the elliptic curve of your public and private ECC keys. Larger elliptic curves provide more cryptographic strength than smaller elliptic curves, but they're also more computationally expensive and take more time to complete the SSL/TLS connection.<p> Select `nistP256` if you're unsure which elliptic curve to use. Elliptic curves larger than `nistP384` aren't recommended.|
|HashAlgorithm (Default / SHA256 / SHA384 / SHA512)| Specifies the hash algorithm of your certificate signature, which your certificate authority will use to verify that your certificate request hasn't been tampered with. Larger hash algorithms provide more cryptographic strength than smaller hash algorithms, but they're also more computationally expensive. Select `SHA256` if you're unsure which hash algorithm to use. Hash algorithms larger than `SHA384` aren't recommended.|
|RsaSignaturePadding | Specifies the RSA signature padding mode for creating and renewing certificates with RSA keys. `Pkcs1` represents the RSASSA-PKCS1-v1_5 padding mode. `Pss` represents the RSASSA-PSS padding mode. The default RSA signature padding mode is `Pkcs1`.|
|CertificateExpirationAttentionThreshold | Specify the number of days before a certificate expires to trigger a certificate expiration notification. This is a reminder of upcoming certificate expirations that can be handled with normal priority. A certificate will only trigger a notification when it's assigned to SharePoint objects. This alert is disabled when set to 0.|
|CertificateExpirationWarningThreshold | Specifies the number of days before a certificate expires to trigger a certificate expiration warning. This is a warning of imminent certificate expirations that should be handled with high priority. A certificate will only trigger a warning when it is assigned to SharePoint objects. This warning is disabled when set to 0.|
|CertificateExpirationErrorThreshold | Specifies the number of days after a certificate expired to trigger a certificate expiration alert. This is an alert about certificates that have already expired and should be handled with critical priority. A certificate will only trigger an alert when it is assigned to SharePoint objects. This alert is disabled when set to 0.|

## Certificates administrative action logging

Major certificate management actions are now logged in the SharePoint Administrative Actions log. The logging actions include:

- Administration.Security.Certificate.Export
- Administration.Security.Certificate.Import
- Administration.Security.Certificate.Install
- Administration.Security.Certificate.Move
- Administration.Security.Certificate.New
- Administration.Security.Certificate.Register
- Administration.Security.Certificate.Remove
- Administration.Security.Certificate.Rename
- Administration.Security.Certificate.Switch
- Administration.Security.Certificate.Uninstall
- Administration.Security.Certificate.Unregister

For more information about administrative action logging, see [Using Administrative Actions logging in SharePoint Server 2016](using-administrative-actions-logging-in-sharepoint-server-2016.md).

## SSL certificate management in Central Administration

Besides managing SSL certificates through PowerShell cmdlets, SharePoint also supports managing your SSL certificates in Central Administration. You'll see a new Certificates section in the Security landing page of Central Administration. Within this section you'll find links to **Manage certificates, Configure certificate management settings, and View certificate files**.

The **Manage certificates** page is the main page for managing the certificates in your SharePoint farm. From here you'll have full access to all of the certificate management functionality including creating new certificates, renewing existing certificates, viewing certificates, importing and exporting certificates, and so on. You'll be able to filter and sort the list of certificates based on various criteria such as certificate store and expiration date.

The **Configure certificate management settings** page lets you configure various settings such as your default organization information and certificate health analyzer rule notification thresholds.

The **View certificate files** page lists the Certificate Signing Request files and certificate export files generated by SharePoint. This makes it easy to retrieve these files even if you're accessing the Central Administration site remotely and don't have direct connectivity to the file shares that SharePoint would have access to.

## New health analyzer rules for SSL certificates

SharePoint has implemented the following four new health analyzer rules for SSL certificates:

1. **Certificate notification contacts haven't been configured** health rule that provides notification through Central Administration when certificates are in use and no certificate notification contacts have been configured. This health rule will run weekly. Certificate notification contacts receive emails about SSL certificate expirations and can be configured by customers through the Configure certificate management settings page.
2. **Upcoming SSL certificate expirations** health rule that provides advanced notification through both Central Administration and email of upcoming certificate expirations. This health rule will run weekly to notify certification notification contacts about certificates that are in use and will expire within the next 15 - 60 days. These thresholds are configurable by customers through the Configure certificate management settings page.
3. **SSL certificates are about to expire** health rule that provides advanced notification through both Central Administration and email when certificates are about to expire. This health rule will run daily to notify certificate notification contacts about certificates that are in use and will expire within the next 15 days. This threshold is configurable by customers through the Configure certificate management settings page.
4. **SSL certificates have expired** health rule that provides notification through both Central Administration and email when certificates have expired. This health rule will run daily to notify certificate notification contacts about certificates that are in use and have expired within the past 15 days. This threshold is configurable by customers through the Configure certificate management settings page.
